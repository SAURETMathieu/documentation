"use strict";(self.webpackChunksauret_doc=self.webpackChunksauret_doc||[]).push([[3533],{5291:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>h,contentTitle:()=>p,default:()=>b,frontMatter:()=>u,metadata:()=>m,toc:()=>f});var a=t(5893),i=t(1151);const l=JSON.parse('{"options":{"name":{"id":"name","label":"Nom","type":"text","placeholder":"Nom","required":true},"lastname":{"id":"lastname","label":"Nom","type":"text","placeholder":"Nom","required":true},"firstname":{"id":"firstname","label":"Pr\xe9nom","type":"text","placeholder":"Pr\xe9nom","required":true},"password":{"id":"password","label":"Mot de passe","type":"password","placeholder":"Mot de passe","required":true},"passwordConfirm":{"id":"passwordConfirm","label":"Confirmer le mot de passe","type":"password","placeholder":"Retaper votre mot de passe","required":true},"nickname":{"id":"nickname","label":"Surnom","type":"text","placeholder":"Surnom","required":false},"year":{"id":"year","label":"Ann\xe9e","type":"number","placeholder":"Ann\xe9e","min":1900,"max":2100,"step":1,"required":true},"city":{"id":"city","label":"Ville","type":"text","placeholder":"Ville","required":true},"country":{"id":"country","label":"Pays","type":"text","placeholder":"Pays","required":true},"function":{"id":"function","label":"Fonction","type":"text","placeholder":"Fonction","required":true},"description":{"id":"description","label":"Description","type":"textarea","placeholder":"Description","required":true,"className":"textarea-container"},"url_image":{"id":"url_image","label":"Image","type":"file","accept":"image/*","required":true,"className":"input-file-container"},"label_id":{"id":"label_id","label":"Labels","type":"select","required":true},"artist_id":{"id":"artist_id","label":"Artiste","type":"select","required":true},"album_id":{"id":"album_id","label":"Albums","type":"select","required":true},"birthdate":{"id":"birthdate","label":"Date de naissance","type":"date","required":true},"zipcode":{"id":"zipcode","label":"Code postal","type":"text","placeholder":"Code postal","required":true},"role":{"id":"role","label":"R\xf4le","type":"text","placeholder":"R\xf4le","required":true},"email":{"id":"email","label":"Email","type":"email","placeholder":"Email","required":true},"type":{"id":"type","label":"Type","type":"text","placeholder":"Type","required":true},"starting_date":{"id":"starting_date","label":"Date de d\xe9but","type":"datetime-local","required":true},"ending_date":{"id":"ending_date","label":"Date de fin","type":"datetime-local","required":true},"location":{"id":"location","label":"Adresse","type":"text","placeholder":"Adresse","required":true},"address":{"id":"address","label":"Adresse","type":"text","placeholder":"Adresse","required":true},"style":{"id":"style","label":"Style","type":"text","placeholder":"Style","required":true},"url":{"id":"url","label":"Lien","type":"text","placeholder":"Lien","required":true},"url_sound":{"id":"url_sound","label":"Son","type":"file","accept":"audio/*","required":true,"className":"input-file-container"}}}');var r=t(7294);const o=function(e){let{options:n,handleInputChange:t,handleFileChange:i}=e;const{id:l,label:r,placeholder:o,defaultValue:s,errorMessage:d,type:c,className:u,disabled:p,title:m,required:h,ariaLabel:f,format:x,pattern:b,minLength:y,maxLength:g,min:j,max:v,step:C,autoComplete:q,multiple:F,accept:N,src:D}=n,I={id:l,name:l,placeholder:o,defaultValue:s,onChange:e=>"file"===c?i(l,e):t(l,e),disabled:p,title:m,required:h,type:c||"text",className:"control has-icons-left has-icons-right","aria-label":f,...d&&{"aria-describedby":`${l}-help`},format:x,pattern:b,minLength:y,maxLength:g,min:j,max:v,step:C,autoComplete:q,multiple:F,accept:N};return(0,a.jsxs)("div",{className:u,children:[r&&(0,a.jsx)("label",{htmlFor:l,className:"label",children:r}),"textarea"===c&&(0,a.jsx)("textarea",{id:l,...I}),"select"===c&&(0,a.jsx)("select",{id:l,...I,children:n&&n.options&&n.options.map((e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id)))}),"textarea"!==c&&"select"!==c&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:c,id:l,...I}),"file"===c&&"url_image"===l&&(0,a.jsx)("img",{className:"image-preview",src:D,alt:"Preview"})]}),d&&(0,a.jsx)("div",{id:`${l}-help`,className:"form-text text-danger",children:d})]})};const s=function(e){let{optionsList:n}=e;const[t,i]=(0,r.useState)({}),[l,s]=(0,r.useState)(!1),[d,c]=(0,r.useState)(0),u=()=>{const e={};n?.forEach((n=>{e[n.id]=n.defaultValue||""})),i(e)};(0,r.useEffect)((()=>{n&&n.length>0&&!l&&(u(),s(!0))}),[n,l]);const p=(e,n)=>{const{value:t}=n.target;i((n=>({...n,[e]:t})))},m=(e,n)=>{i({...t,[e]:n.target.files[0]}),"url_image"===n.target.name&&(document.querySelector(".image-preview").src=URL.createObjectURL(n.target.files[0]))},h=async e=>{e.preventDefault();const n=e.target.closest("form");n&&n.checkValidity()?(t.password&&t.passwordConfirm||(delete t.password,delete t.passwordConfirm),console.log("Envoi des donn\xe9es."),c((e=>e+1))):console.error("Certains champs du formulaire ne sont pas valides.")};return(0,a.jsxs)("form",{className:"create-form",onSubmit:h,encType:"multipart/form-data",children:[n&&n.map((e=>(0,a.jsx)(o,{options:e,handleInputChange:p,handleFileChange:m},e.id))),(0,a.jsxs)("div",{className:"submit-buttons",children:[(0,a.jsx)("button",{type:"button",className:"is-cancel close-modal-btn",onClick:()=>{u(),c((e=>e+1))},"aria-label":"reset formulaire",children:"Annuler"}),(0,a.jsx)("button",{type:"submit",className:"is-success",onClick:h,"aria-label":"valider le formulaire",children:"Envoyer"})]})]},d)},{options:d}=l;const c=function(){const e=[d.firstname,d.lastname,d.nickname,d.year,d.city,d.country,d.description,d.function,d.url_image];return(0,a.jsx)(s,{optionsList:e})},u={id:"template-auto-form",title:"Template de formulaire dynamique",sidebar_label:"Template de formulaire dynamique"},p=void 0,m={id:"react/templates/template-auto-form",title:"Template de formulaire dynamique",description:"Composant Input",source:"@site/docs/react/templates/input.mdx",sourceDirName:"react/templates",slug:"/react/templates/template-auto-form",permalink:"/docs/react/templates/template-auto-form",draft:!1,unlisted:!1,editUrl:"https://github.com/SAURETMathieu/docs/react/templates/input.mdx",tags:[],version:"current",frontMatter:{id:"template-auto-form",title:"Template de formulaire dynamique",sidebar_label:"Template de formulaire dynamique"},sidebar:"reactSidebar",previous:{title:"Templates",permalink:"/docs/react/templates"},next:{title:"Template de tableau Back-office",permalink:"/docs/react/templates/template-table"}},h={},f=[{value:"Composant Input",id:"composant-input",level:2},{value:"Utilisation du composant Input de mani\xe8re dynamique",id:"utilisation-du-composant-input-de-mani\xe8re-dynamique",level:2},{value:"Initialisation des options",id:"initialisation-des-options",level:2},{value:"Initialiser le formulaire",id:"initialiser-le-formulaire",level:2},{value:"UseEffect de l&#39;initialisation du formulaire",id:"useeffect-de-linitialisation-du-formulaire",level:2},{value:"Fonction handleInputChange",id:"fonction-handleinputchange",level:2},{value:"Fonction handleFileChange",id:"fonction-handlefilechange",level:2},{value:"Template de formulaire",id:"template-de-formulaire",level:2},{value:"Fonction handleSubmit",id:"fonction-handlesubmit",level:2},{value:"Exemple de cr\xe9ation de formulaire",id:"exemple-de-cr\xe9ation-de-formulaire",level:2},{value:"Formulaire obtenu",id:"formulaire-obtenu",level:3}];function x(e){const n={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"composant-input",children:"Composant Input"}),"\n",(0,a.jsxs)(n.p,{children:["Cr\xe9ez un composant ",(0,a.jsx)(n.code,{children:"Input"})," qui prend en param\xe8tre les options n\xe9cessaires pour cr\xe9er un champ de formulaire."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'import React from "react";\n\nfunction Input({ options, handleInputChange, handleFileChange }) {\n  const {\n    id,\n    label,\n    placeholder,\n    defaultValue,\n    errorMessage,\n    type,\n    className,\n    disabled,\n    title,\n    required,\n    ariaLabel,\n    format,\n    pattern,\n    minLength,\n    maxLength,\n    min,\n    max,\n    step,\n    autoComplete,\n    multiple,\n    accept,\n    src,\n  } = options;\n\n  const inputProps = {\n    id,\n    name: id,\n    placeholder,\n    defaultValue,\n    onChange: (event) =>\n      type === "file"\n        ? handleFileChange(id, event)\n        : handleInputChange(id, event),\n    disabled,\n    title,\n    required,\n    type: type || "text",\n    className: "control has-icons-left has-icons-right",\n    "aria-label": ariaLabel,\n    ...(errorMessage && { "aria-describedby": `${id}-help` }),\n    format,\n    pattern,\n    minLength,\n    maxLength,\n    min,\n    max,\n    step,\n    autoComplete,\n    multiple,\n    accept,\n  };\n\n  return (\n    <div className={className}>\n      {label && (\n        <label htmlFor={id} className="label">\n          {label}\n        </label>\n      )}\n      {type === "textarea" && <textarea id={id} {...inputProps} />}\n      {type === "select" && (\n        <select id={id} {...inputProps}>\n          {options &&\n            options.options &&\n            options.options.map((option) => (\n              <option key={option.id} value={option.id}>\n                {option.name}\n              </option>\n            ))}\n        </select>\n      )}\n      {type !== "textarea" && type !== "select" && (\n        <>\n          <input type={type} id={id} {...inputProps} />\n          {type === "file" && id === "url_image" && (\n            <img className="image-preview" src={src} alt="Preview" />\n          )}\n        </>\n      )}\n      {errorMessage && (\n        <div id={`${id}-help`} className="form-text text-danger">\n          {errorMessage}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Input;\n'})}),"\n",(0,a.jsx)(n.h2,{id:"utilisation-du-composant-input-de-mani\xe8re-dynamique",children:"Utilisation du composant Input de mani\xe8re dynamique"}),"\n",(0,a.jsxs)(n.p,{children:["Utilisez le composant ",(0,a.jsx)(n.code,{children:"Input"})," en passant les options n\xe9cessaires."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:"<Input\n  key={options.id}\n  options={options}\n  handleInputChange={handleInputChange}\n  handleFileChange={handleFileChange}\n/>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"initialisation-des-options",children:"Initialisation des options"}),"\n",(0,a.jsxs)(n.p,{children:["Cr\xe9ez un fichier ",(0,a.jsx)(n.code,{children:"options.json"})," qui contient les options n\xe9cessaires pour cr\xe9er un bouton ou cr\xe9ez un objet ",(0,a.jsx)(n.code,{children:"options"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Par exemple:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "options": {\n    "lastname": {\n      "id": "lastname",\n      "label": "Nom",\n      "type": "text",\n      "placeholder": "Nom",\n      "required": true\n    },\n    "firstname": {\n      "id": "firstname",\n      "label": "Pr\xe9nom",\n      "type": "text",\n      "placeholder": "Pr\xe9nom",\n      "required": true\n    },\n    "password": {\n      "id": "password",\n      "label": "Mot de passe",\n      "type": "password",\n      "placeholder": "Mot de passe",\n      "required": true\n    },\n    "year": {\n      "id": "year",\n      "label": "Ann\xe9e",\n      "type": "number",\n      "placeholder": "Ann\xe9e",\n      "min": 1900,\n      "max": 2100,\n      "step": 1,\n      "required": true\n    },\n    "description": {\n      "id": "description",\n      "label": "Description",\n      "type": "textarea",\n      "placeholder": "Description",\n      "required": true,\n      "className": "textarea-container"\n    },\n    "label_id": {\n      "id": "label_id",\n      "label": "Labels",\n      "type": "select",\n      "required": true\n    },\n    "starting_date": {\n      "id": "starting_date",\n      "label": "Date de d\xe9but",\n      "type": "datetime-local",\n      "required": true\n    },\n    "url_sound": {\n      "id": "url_sound",\n      "label": "Son",\n      "type": "file",\n      "accept": "audio/*",\n      "required": true,\n      "className": "input-file-container"\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"initialiser-le-formulaire",children:"Initialiser le formulaire"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'const [formData, setFormData] = useState({});\n\nconst initialForm = () => {\n  const initialFormData = {};\n\n  optionsList?.forEach((option) => {\n    initialFormData[option.id] = option.defaultValue || "";\n  });\n\n  setFormData(initialFormData);\n};\n'})}),"\n",(0,a.jsx)(n.h2,{id:"useeffect-de-linitialisation-du-formulaire",children:"UseEffect de l'initialisation du formulaire"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:"const [formInit, setFormInit] = useState(false);\n\nuseEffect(() => {\n  if (optionsList && optionsList.length > 0 && !formInit) {\n    initialForm();\n    setFormInit(true);\n  }\n}, [optionsList, formInit]);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"fonction-handleinputchange",children:"Fonction handleInputChange"}),"\n",(0,a.jsxs)(n.p,{children:["Cr\xe9ez une fonction ",(0,a.jsx)(n.code,{children:"handleInputChange"})," qui met \xe0 jour le formulaire lorsqu'un champ est modifi\xe9."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:"const handleInputChange = (id, event) => {\n  const { value } = event.target;\n  setFormData((prevFormData) => ({\n    ...prevFormData,\n    [id]: value,\n  }));\n};\n"})}),"\n",(0,a.jsx)(n.h2,{id:"fonction-handlefilechange",children:"Fonction handleFileChange"}),"\n",(0,a.jsxs)(n.p,{children:["Cr\xe9ez une fonction ",(0,a.jsx)(n.code,{children:"handleFileChange"})," qui met \xe0 jour le formulaire lorsqu'un fichier est ajout\xe9."]}),"\n",(0,a.jsxs)(n.p,{children:["Si le champ est de type ",(0,a.jsx)(n.code,{children:"file"})," et que l'id est ",(0,a.jsx)(n.code,{children:"url_image"}),", cela permet de changer la pr\xe9visualisation de l'image."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'const handleFileChange = (id, event) => {\n  setFormData({\n    ...formData,\n    [id]: event.target.files[0],\n  });\n  if (event.target.name === "url_image") {\n    document.querySelector(".image-preview").src = URL.createObjectURL(\n      event.target.files[0]\n    );\n  }\n};\n'})}),"\n",(0,a.jsx)(n.h2,{id:"template-de-formulaire",children:"Template de formulaire"}),"\n",(0,a.jsxs)(n.p,{children:["Ce composant ",(0,a.jsx)(n.code,{children:"AutoForm"})," permet de cr\xe9er un formulaire dynamique en passant les options n\xe9cessaires."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'return (\n  <form\n    key={formKey}\n    className="create-form"\n    onSubmit={handleSubmit}\n    encType="multipart/form-data"\n  >\n    {optionsList &&\n      optionsList.map((options) => (\n        <Input\n          key={options.id}\n          options={options}\n          handleInputChange={handleInputChange}\n          handleFileChange={handleFileChange}\n        />\n      ))}\n    <div className="modal-submit-buttons">\n      <button\n        type="button"\n        className="is-cancel close-modal-btn"\n        onClick={handleClose}\n        aria-label="Close modal"\n      >\n        Annuler\n      </button>\n      <button\n        type="submit"\n        className="is-success"\n        onClick={handleSubmit}\n        aria-label="Valid form"\n      >\n        Confirmer\n      </button>\n    </div>\n  </form>\n);\n'})}),"\n",(0,a.jsx)(n.h2,{id:"fonction-handlesubmit",children:"Fonction handleSubmit"}),"\n",(0,a.jsxs)(n.p,{children:["Cr\xe9ez une fonction ",(0,a.jsx)(n.code,{children:"handleSubmit"})," qui envoie les donn\xe9es du formulaire \xe0 l'API."]}),"\n",(0,a.jsxs)(n.p,{children:["A noter que si le mode est ",(0,a.jsx)(n.code,{children:"create"}),", les donn\xe9es sont envoy\xe9es en ",(0,a.jsx)(n.code,{children:"POST"}),", sinon en ",(0,a.jsx)(n.code,{children:"PATCH"}),".\nDans le cas d'une cr\xe9ation, les donn\xe9es sont ajout\xe9es \xe0 la liste, sinon elles sont mises \xe0 jour."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:'const handleSubmit = async (event) => {\n  event.preventDefault();\n  const formElement = event.target.closest("form");\n\n  if (formElement && formElement.checkValidity()) {\n    if (!formData.password || !formData.passwordConfirm) {\n      delete formData.password;\n      delete formData.passwordConfirm;\n    }\n    const resultData =\n      modalMode === "create"\n        ? await fetchData("POST", route, formData, true)\n        : await fetchData(\n            "PATCH",\n            `${route}/${itemSelected.id}`,\n            formData,\n            true\n          );\n    if (resultData) {\n      if (modalMode === "create") {\n        handleDataCreate(resultData[0]);\n        toast.success("Cr\xe9ation r\xe9ussie.");\n      }\n      if (modalMode === "update") {\n        handleDataUpdate(resultData[0]);\n        toast.success("Modification r\xe9ussie.");\n      }\n      setFormKey((prevKey) => prevKey + 1);\n      setItemSelected(null);\n      handleClose();\n    }\n  } else {\n    toast.error("Certains champs du formulaire ne sont pas valides.");\n  }\n};\n'})}),"\n",(0,a.jsx)(n.h2,{id:"exemple-de-cr\xe9ation-de-formulaire",children:"Exemple de cr\xe9ation de formulaire"}),"\n",(0,a.jsxs)(n.p,{children:["Vous pouvez cr\xe9er un formulaire en utilisant le composant ",(0,a.jsx)(n.code,{children:"AutoForm"})," et en passant les options n\xe9cessaires."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",children:"function ArtistForm() {\n  const optionsList = [\n    options.firstname,\n    options.lastname,\n    options.nickname,\n    options.year,\n    options.city,\n    options.country,\n    options.description,\n    options.function,\n    options.url_image,\n  ];\n\n  return <AutoForm optionsList={optionsList} />;\n}\n\nexport default ArtistForm;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"formulaire-obtenu",children:"Formulaire obtenu"}),"\n",(0,a.jsxs)(n.p,{children:["Ainsi vous obtenez un formulaire dynamique en modifiant uniquement l'objet ",(0,a.jsx)(n.code,{children:"optionsList"}),"."]}),"\n","\n",(0,a.jsx)(c,{})]})}function b(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(x,{...e})}):x(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>r});var a=t(7294);const i={},l=a.createContext(i);function r(e){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);